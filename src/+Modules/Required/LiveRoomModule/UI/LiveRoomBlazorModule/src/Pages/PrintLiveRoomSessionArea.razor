@page "/liveRoom/printliveRoomSession/{LiveRoomSessionId:guid}"
@layout PrintLiveRoomSessionLayout

@inject IStringLocalizer<LiveRoomSessionArea> Localize


<PageTitle>LIVEROOM - @_liveRoomSessionTitle</PageTitle>


<MudContainer MaxWidth="MaxWidth.ExtraExtraLarge">
    @if(_chosenLiveRoomSession != null) {
        <LiveRoomSessionComponent LiveRoomSession="@_chosenLiveRoomSession" OnRecreateLiveRoomSession=OnRecreateLiveRoomSession SelectedGridCells=SelectedGridCells SelectedGridCellPoints=SelectedGridCellPoints />
    }
</MudContainer>



@code {
    [Parameter] 
    public Guid LiveRoomSessionId { get; set; }
    private LiveRoomSessionViewModel _chosenLiveRoomSession { get; set; }
    private string _liveRoomSessionTitle { get; set; } = "Word Search Title";
    protected char[,] SelectedGridCells { get; set; }
    protected List<System.Drawing.Point> SelectedGridCellPoints { get; set; } = new();


    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        var liveRoomSessionGetByIdRequest = new LiveRoomSessionGetByIdRequest(LiveRoomSessionId);
        _chosenLiveRoomSession = await LiveRoomDataService.LiveRoomSessionGetByIdAsync(liveRoomSessionGetByIdRequest);
        SelectedGridCells = LiveRoomSessionGridUtility.ConvertRowCellStringToArray(_chosenLiveRoomSession.LiveRoomSessionGrid.RowCellData);
        SelectedGridCellPoints = LiveRoomSessionGridUtility.ConvertSelectedWordsToPointList(_chosenLiveRoomSession.LiveRoomSessionGrid.CompletedWordCellData);        
        _liveRoomSessionTitle = _chosenLiveRoomSession.Title;
    }

    public async Task OnRecreateLiveRoomSession(){
        var request = new LiveRoomSessionGetFullGridRequest(_chosenLiveRoomSession.Id);
        _chosenLiveRoomSession = await LiveRoomDataService.LiveRoomSessionGetFullGridAsync(request);         
        SelectedGridCells = LiveRoomSessionGridUtility.ConvertRowCellStringToArray(_chosenLiveRoomSession.LiveRoomSessionGrid.RowCellData);
        SelectedGridCellPoints = LiveRoomSessionGridUtility.ConvertSelectedWordsToPointList(_chosenLiveRoomSession.LiveRoomSessionGrid.CompletedWordCellData);               
    }

}